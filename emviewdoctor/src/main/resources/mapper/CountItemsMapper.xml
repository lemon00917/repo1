<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dhcens.emviewdoctor.mapper.CountItemsMapper">

<!--auto generated by MybatisCodeHelper on 2020-01-16-->
    <select id="selectDiagnosecount" resultType="java.lang.Integer">
        select count(0)
        from hdc_user.pa_diagnose pa_diagnose
        left join hdc_user.pa_adm pa_adm on pa_adm.paadm_visitnumber=pa_diagnose.pad_visitnumber
        left join hdc_user.rel_patient rel_patient on rel_patient.repat_patientid=pa_adm.paadm_patientid
        <where>
            <trim prefixOverrides="and">
                <if test="paramsobject.PATPatientID != null and paramsobject.PATPatientID !=''  ">
                    and rel_patient.repat_patientid=#{paramsobject.PATPatientID}
                </if>
                <if test="paramsobject.HosPatientID != null and paramsobject.HosPatientID !=''  ">
                    and rel_patient.repat_hospatientid=#{paramsobject.HosPatientID}
                </if>
                <if test="paramsobject.PatVisitNumberIndex != null and paramsobject.PatVisitNumberIndex.size>0">
                    and pa_adm.paadm_visitnumber in
                    <foreach collection="paramsobject.PatVisitNumberIndex" item="item" separator=","
                        open="(" close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
    </select>
    <select id="selectOeordItemcount" resultType="java.lang.Integer">
        select count(0)
        from hdc_user.oe_orditem oe_orditem
        inner join hdc_user.oe_order or_order on or_order.oeord_orderid = oe_orditem.oeori_orderid
        inner join hdc_user.pa_adm pa_adm on or_order.oeord_visitnumber = pa_adm.paadm_visitnumber
        <where>
            <trim prefixOverrides="and">
                <if test="paramsobject.PATPatientID != null and paramsobject.PATPatientID !=''  ">
                    and pa_adm.paadm_patientid=#{paramsobject.PATPatientID}
                </if>

                <if test="paramsobject.PatVisitNumberIndex != null and paramsobject.PatVisitNumberIndex.size>0">
                    and pa_adm.paadm_visitnumber in
                    <foreach collection="paramsobject.PatVisitNumberIndex"  item="item"  separator="," open="(" close=")">
                        #{item}
                    </foreach>
                </if>

            </trim>
        </where>
    </select>
    <select id="selectRisReportcount" resultType="java.lang.Integer">
        select count(0)
        from hdc_user.rel_risexamid
        inner join HDC_USER.ris_order a on rel_risexamid.rreid_examid = a.riso_examid
        inner join HDC_USER.pa_adm b on rel_risexamid.rreid_visitnumber = b.paadm_visitnumber
        <where>
            <trim prefixOverrides="and">
                <if test="paramsobject.PatVisitNumberIndex != null and paramsobject.PatVisitNumberIndex.size>0">
                    and b.paadm_visitnumber in
                    <foreach collection="paramsobject.PatVisitNumberIndex" item="item" separator="," open="(" close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="paramsobject.PATPatientID !=null and paramsobject.PATPatientID !=''">
                    and b.paadm_patientid = #{paramsobject.PATPatientID}
                </if>
            </trim>
        </where>
    </select>
    <select id="selectLisReportcount" resultType="java.lang.Integer">
        select count(0)
        from hdc_user.lis_itemresult lis_itemresult
        inner join hdc_user.lis_reportresult lis_reportresult
        on lis_itemresult.lisir_reportid = lis_reportresult.lisrr_reportid
        <where>
            <trim prefixOverrides="and">
                <if test="paramsobject.PATPatientID != null and paramsobject.PATPatientID != ''">
                    and lis_reportresult.lisrr_patientid=#{paramsobject.PATPatientID}
                </if>
                <if test="paramsobject.PatVisitNumberIndex != null and paramsobject.PatVisitNumberIndex.size() != 0">
                    and lis_reportresult.lisrr_visitnumber in
                    <foreach collection="paramsobject.PatVisitNumberIndex"  item="item"  separator="," open="(" close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
    </select>
    <select id="selectMedicalDetialcount" resultType="java.lang.Integer">
        select count(0)
        from hdc_user.oe_orditem oe_orditem
        inner join hdc_user.oe_order or_order on or_order.oeord_orderid = oe_orditem.oeori_orderid
        inner join hdc_user.pa_adm pa_adm on or_order.oeord_visitnumber = pa_adm.paadm_visitnumber
        left join hdc_user.ct_arcitmmast ct_arcitmmast on ct_arcitmmast.ctarcim_code = oe_orditem.oeori_arcitmmastcode
        left join hdc_user.ct_childcategory ct_childcategory
        on ct_childcategory.ctcc_code = ct_arcitmmast.ctarcim_childcategory
        left join hdc_user.ct_category ct_category on ct_category.ctc_code = ct_childcategory.ctcc_category
        <where>
            <trim prefixOverrides="and">
                <if test="paramsobject.PATPatientID != null and paramsobject.PATPatientID !=''  ">
                    and pa_adm.paadm_patientid=#{paramsobject.PATPatientID}
                </if>
                <if test="paramsobject.PatVisitNumberIndex != null and paramsobject.PatVisitNumberIndex.size()>0">
                    and pa_adm.paadm_visitnumber in
                    <foreach collection="paramsobject.PatVisitNumberIndex"  item="item"  separator="," open="(" close=")">
                        #{item}
                    </foreach>
                </if>
                and ct_category.ctc_code in ('01','02','03')

            </trim>
        </where>
    </select>
</mapper>